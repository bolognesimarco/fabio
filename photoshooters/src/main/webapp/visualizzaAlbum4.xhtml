<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:p="http://primefaces.org/ui">

<h:head>
 	<h:outputStylesheet name="common.css" library="css" />
	<h:outputStylesheet name="homePage.css" library="css" />	
	<h:outputStylesheet name="photoswipe.css" library="css" />
	<h:outputStylesheet name="dataGrid.css" library="css" />
	<h:outputStylesheet name="calendar.css" library="css" />
	<link rel="stylesheet" href="resources/css/default-skin/default-skin.css"/> 
	<h:outputScript name="photoswipe.js" library="js" />
	<h:outputScript name="photoswipe-ui-default.js" library="js" /> 
	<h:outputScript name="gallery.js" library="js" />
	
<!-- <script type="text/javascript"> -->
<!-- // var openPhotoSwipe = function() { -->
<!-- // var pswpElement = document.querySelectorAll('.pswp')[0]; -->

<!-- // //build items array -->
<!-- // var items = #{utenteBean.pswpS}; -->
<!-- // /*     { -->
<!-- //         src: 'https://farm2.staticflickr.com/1043/5186867718_06b2e9e551_b.jpg', -->
<!-- //         w: 964, -->
<!-- //         h: 1024 -->
<!-- //     }, -->
<!-- //     { -->
<!-- //         src: 'https://farm7.staticflickr.com/6175/6176698785_7dee72237e_b.jpg', -->
<!-- //         w: 1024, -->
<!-- //         h: 683 -->
<!-- //     } , -->
<!-- // 	 { -->
<!-- // 	     src: 'http://localhost:8080/lil?path=fb/AlbumFB1/nomeFotoFB1.jpg', -->
<!-- // 	     w: 800, -->
<!-- // 	     h: 600 -->
<!-- // 	 } -->
<!-- // ]; -->
<!-- //  */ -->
<!-- // //define options (if needed) -->
<!-- // var options = { -->
<!-- //  // optionName: 'option value' -->
<!-- //  // for example: -->
<!-- //  index: 0 // start at first slide -->
<!-- // }; -->

<!-- // //Initializes and opens PhotoSwipe -->
<!-- // var gallery = new PhotoSwipe( pswpElement, PhotoSwipeUI_Default, items, options); -->
<!-- // gallery.init(); -->

<!-- // }; -->

<!-- // //openPhotoSwipe(); -->

<!-- // document.getElementById('btn').onclick = openPhotoSwipe; -->

<!-- </script> -->
</h:head>

<h:body>
	
	
	
	<!-- Root element of PhotoSwipe. Must have class pswp. -->

<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader-active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<h:panelGroup styleClass="pannello homepage">

 <h:panelGrid>
			<f:facet name="header">
            		<h:outputText id="username" value="#{utenteBean.utente.username}"/>
            	    <h:outputText value="&#160;-&#160;FOTOs ALMBUm :&#160;"/>
            		<h:outputText id="nomeAlbum" value="#{utenteBean.risultatoAlbum.titolo}"/>
        	</f:facet>
	
	<p:dataGrid id="my-gallery" value="#{utenteBean.risultatoFotos}" var="risultato" 
      columns="4" rows="5" paginator="true"  rowsPerPageTemplate="5,10,15">  
			    <p:column>
				<figure itemprop="associatedMedia" itemscope="true" itemtype="http://schema.org/ImageObject" id="#{risultato.id}"> 
					<a href="/lil?path=#{utenteBean.utente.username}/#{utenteBean.risultatoAlbum.titolo}/#{risultato.nomeFileFoto}" itemprop="contentUrl" data-size="#{risultato.larghezzaFoto}x#{risultato.altezzaFoto}">
						<h:graphicImage itemprop="thumbnail"
							value="/lil?path=#{utenteBean.utente.username}/#{utenteBean.risultatoAlbum.titolo}/#{risultato.nomeFileFoto}"
							height="51" width="50">
						</h:graphicImage>
					</a> 
					<figcaption itemprop="caption description"> 
						<h:outputText value="#{risultato.titolo}" />
						<h:outputText value="#{risultato.dataFoto}" />
					</figcaption> 
				</figure>
				<h:commandButton value="ELIMINa" styleClass="menubuttonorange" >
					<f:ajax event="click" listener="#{utenteBean.cancellaFoto(risultato.id)}" render=":content" />
				</h:commandButton>
<!-- 				<p:graphicImage id="modifica"  name="/images/modifica_C.svg"></p:graphicImage> -->
				<h:commandButton id="modifica" value="MODIFICa" styleClass="menubuttonwhite" />
				<p:overlayPanel for="modifica" id="modificaFoto" appendToBody="false" >

						<h:panelGrid>
							<h:graphicImage value="/lil?path=#{utenteBean.utente.username}/#{utenteBean.risultatoAlbum.titolo}/#{risultato.nomeFileFoto}"
								height="150" width="150"></h:graphicImage>
							
							<h:inputText value="#{utenteBean.titoloFotoModifica}" />
							<h:inputText value="#{risultato.dataFoto}" />
							<p:commandLink  value="AGGIORNa FOTo" action="#{utenteBean.aggiornaFoto2(risultato)}" />
	
						</h:panelGrid>

				</p:overlayPanel>
				</p:column>
	</p:dataGrid>
		
	<h:dataTable value="#{utenteBean.risultatoFotos}" border="1" var="result">
	 <h:column>
		<h:outputText value="#{result.nomeFileFoto}"></h:outputText>
		</h:column>
	</h:dataTable>
		
<br>
</br>


			<h:form id="nuovafotoform" enctype="multipart/form-data" >
			   <h:panelGrid columns="2" border="1">
			   
				<h:outputLabel for="newFotoName">TITOLo FOTo</h:outputLabel>
				<h:inputText id="newFotoName" value="#{utenteBean.nuovaFoto.titolo}"/>

				<h:outputLabel for="newFotoDescrizione">DESCRIZIONe FOTo</h:outputLabel>
				<h:inputTextarea size="50" rows="6" id="newFotoDescrizione" value="#{utenteBean.nuovaFoto.descrizione}"/>

				<h:outputLabel for="fotografoFoto">FOTOGRAFo/a FOTo</h:outputLabel>
				<p:autoComplete id="fotografoFoto" value="#{utenteBean.nuovaFoto.fotografo}" completeMethod="#{utenteBean.suggerisciUtente}" converter="entityConverter" var="complete" itemValue="#{complete}" itemLabel="#{complete.username}"></p:autoComplete>
				
				<h:outputLabel for="soggettoFoto">SOGGETTo FOTo</h:outputLabel>
				<p:autoComplete id="soggettoFoto" value="#{utenteBean.nuovaFoto.soggetto}" completeMethod="#{utenteBean.suggerisciUtente}" converter="entityConverter" var="complete" itemValue="#{complete}" itemLabel="#{complete.username}"></p:autoComplete>
				
				<h:outputLabel for="collaboratoriFoto">COLLABORATORi FOTo</h:outputLabel>
				<p:autoComplete id="collaboratoriFoto" value="#{utenteBean.nuovaFoto.collaboratori}" completeMethod="#{utenteBean.suggerisciUtente}" converter="entityConverter" var="complete" itemValue="#{complete}" itemLabel="#{complete.username}" multiple="true"></p:autoComplete>

				<h:outputLabel for="dataFoto">DATa SCATTo</h:outputLabel>
				<p:calendar readonlyInput="true" id="dataFoto" value="#{utenteBean.nuovaFoto.dataFoto}" navigator="true" styleClass="calendar" yearRange="c-80:c+20" pattern="dd-MMM-yyyy" />	

				<h:outputLabel for="città">LUOGo SCATTo</h:outputLabel>
 				<p:autoComplete maxlength="130" id="città" value="#{utenteBean.nuovaFoto.luogoScatto}" completeMethod="#{utenteBean.suggerisciCittà}" />	
	
				<h:outputLabel for="vietataminori">CONTIENe NUDITà (VM 18)</h:outputLabel>
				<h:selectBooleanCheckbox id="vietataminori" value="#{utenteBean.nuovaFoto.vietataMinori}">
				</h:selectBooleanCheckbox>

				<h:inputFile id="foto"  label="SFOGLIa" value="#{inputBean.part}"
						required="true" requiredMessage="Selezionare foto per upload!">
					<f:validator validatorId="FileUploadValidator" />
				</h:inputFile>
				<h:message for="foto" />

				<h:outputText value="#{inputBean.statusMessage}" rendered="#{not empty inputBean.statusMessage}" />
				<h:outputText style="color: red" value="#{contentBean.messaggio}"></h:outputText>
				
				<h:commandButton id="submit" action="#{inputBean.uploadFoto()}" value="UPLOAd FOTo" />
				
				</h:panelGrid>
			</h:form>

				<f:facet name="footer">
		            <h:panelGroup>
				         <h:outputText value="&#160;&#160;FOTOs ALMBUm&#160;&#160;"/>
	            	</h:panelGroup>
        	</f:facet>

</h:panelGrid>

</h:panelGroup>

</h:body>
</html>